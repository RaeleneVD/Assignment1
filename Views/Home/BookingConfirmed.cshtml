@{
    ViewBag.Title = "Booking Confirmed";
}

<!--Add images? where??-->

<style>
    /*Add stying*/
    .confirmed-container {
        background-color: #f0f8ff;
        padding: 30px;
        border-radius: 10px;
        margin-top: 40px;
        box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }

    .booking-detail {
        margin-bottom: 20px;
    }

    .sos-booking {
        border: 2px solid red;
        background-color: #fff0f0;
    }

    img.booking-img {
        max-width: 100%;
        height: 180px;
        object-fit: cover;
        border-radius: 6px;
        margin-bottom: 10px;
    }

    h2 {
        margin-bottom: 25px;
        color: #2c3e50;
    }

    .label-bold {
        font-weight: bold;
    }
</style>

<div class="container confirmed-container" id="confirmationBox">
    <h2>🚑 Booking Confirmed!</h2> <!--Windows and . for emojies-->
    <div id="bookingDetails"> <!--The html needs to go here. DYnamic how? Stored in Local storage but how?--></div>
</div>

@section Scripts {
    <script>
        //get latest from local storage
        const latest = JSON.parse(localStorage.getItem("latestBooking") || "null");// anything other than parse???

        function showBooking() {  //has to show latest entry
            if (!latest) {
                document.getElementById("bookingDetails").innerHTML = "<p>No booking found.</p>";  //if nothing
                return;
            }

            const isSOS = latest.isSOS;  //Lets make sos stand out
            const wrapper = document.getElementById("confirmationBox");

            if (isSOS) {
                wrapper.classList.add("sos-booking");
            }

            let html = `
                <div class="booking-detail"><span class="label-bold">Booking ID:</span> ${latest.id}</div>
                <div class="booking-detail"><span class="label-bold">Date:</span> ${latest.date}</div>
                <div class="booking-detail"><span class="label-bold">Service Type:</span> ${latest.type}</div>
                <div class="booking-detail"><span class="label-bold">Name:</span> ${latest.name ?? 'N/A'}</div>
                <div class="booking-detail"><span class="label-bold">Phone:</span> ${latest.phone ?? 'N/A'}</div>
                <div class="booking-detail"><span class="label-bold">Pickup Address:</span> ${latest.pickup ?? 'N/A'}</div>
                <div class="booking-detail"><span class="label-bold">Pickup Time:</span> ${latest.time ?? 'N/A'}</div>
                <div class="booking-detail"><span class="label-bold">Reason:</span> ${latest.reason ?? 'N/A'}</div>

                <h4 class="mt-4">Driver Info:</h4>
                ${latest.driver?.image ? `<img class="booking-img" src="/Content/Images/${latest.driver.image}" alt="Driver">` : ''}
                <div class="booking-detail"><span class="label-bold">Driver Name:</span> ${latest.driver?.name ?? 'N/A'}</div>

                <h4 class="mt-4">Vehicle Info:</h4>
                ${latest.vehicle?.image ? `<img class="booking-img" src="/Content/Images/${latest.vehicle.image}" alt="Vehicle">` : ''}
                <div class="booking-detail"><span class="label-bold">Vehicle Model:</span> ${latest.vehicle?.model ?? 'N/A'}</div>
            `;

            document.getElementById("bookingDetails").innerHTML = html;
        }

        document.addEventListener("DOMContentLoaded", showBooking);
    </script>
}
